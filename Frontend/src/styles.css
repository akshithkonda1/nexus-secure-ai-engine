:root { color-scheme: dark; }
html, body, #root { height: 100%; margin: 0; }
[data-theme="light"] { color-scheme: light; background: #fff; color: #111; }
[data-theme="dark"] { color-scheme: dark; background: #0b0d10; color: #e8e8e8; }

.topbar { display: flex; align-items: center; justify-content: space-between; padding: 10px 16px; border-bottom: 1px solid #333; position: sticky; top: 0; backdrop-filter: saturate(180%) blur(6px); }
.topbar .brand { font-weight: 700; text-decoration: none; color: inherit; }
.topbar nav a { margin: 0 8px; text-decoration: none; color: inherit; opacity: .8; }
.topbar nav a.active { opacity: 1; border-bottom: 2px solid currentColor; }
.icon-btn {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  width: 36px;
  height: 36px;
  border-radius: 10px;
  background: #1c1c22;
  color: #e5e7eb;
  border: 1px solid rgba(255, 255, 255, .08);
}
.icon-btn:hover { background: #23232a; }
.icon-btn.is-active { outline: 2px solid #6366f1; outline-offset: 0; }

.container { max-width: 980px; margin: 0 auto; padding: 16px; }
.footer { text-align: center; padding: 12px; border-top: 1px solid #333; opacity: .7; }

.chat-wrap { display: flex; flex-direction: column; gap: 12px; }
.msgs { display: flex; flex-direction: column; gap: 12px; min-height: 50vh; }
.msg { display: flex; }
.msg.user { justify-content: flex-end; }
.msg.assistant { justify-content: flex-start; }
.bubble { max-width: 70%; padding: 12px 14px; border-radius: 14px; line-height: 1.5; background: #1a1f26; }
.msg.user .bubble { background: #2a6bf3; color: white; }
.composer { display: flex; gap: 8px; }
.composer textarea { flex: 1; resize: vertical; padding: 10px; border-radius: 10px; background: #11161b; color: inherit; border: 1px solid #2a2f35; }
.composer button { padding: 10px 14px; border-radius: 10px; border: 1px solid #2a2f35; background: #131820; color: inherit; }

.sources { margin-top: 8px; }
.sources summary { cursor: pointer; }
.snippet { opacity: .8; font-size: .9em; }

.modal-backdrop { position: fixed; inset: 0; background: rgba(0, 0, 0, .5); display: grid; place-items: center; }
.modal { background: #0f141a; border: 1px solid #2a2f35; border-radius: 12px; padding: 16px; width: min(480px, 92vw); }
.modal input, .modal select { width: 100%; padding: 8px; margin: 6px 0 12px; border-radius: 8px; border: 1px solid #2a2f35; background: #11161b; color: inherit; }
.modal .row { display: flex; gap: 8px; justify-content: flex-end; }
.modal .ghost { background: transparent; }
.fineprint { opacity: .7; font-size: .85em; margin-top: 8px; text-align: right; }

.workspace-modal-backdrop { z-index: 60; align-items: flex-start; justify-content: center; padding: 40px 16px; overflow-y: auto; }
.workspace-modal { position: relative; background: #0f141a; border: 1px solid #2a2f35; border-radius: 20px; width: min(720px, 92vw); box-shadow: 0 40px 80px rgba(0, 0, 0, .45); color: inherit; display: flex; flex-direction: column; max-height: min(80vh, 680px); }
.workspace-modal-scroll { flex: 1; display: flex; flex-direction: column; overflow-y: auto; }
.workspace-modal-header { position: sticky; top: 0; display: flex; align-items: center; justify-content: space-between; gap: 16px; padding: 20px 24px; border-bottom: 1px solid rgba(255, 255, 255, .08); background: rgba(15, 20, 26, .95); backdrop-filter: blur(12px); z-index: 1; }
.workspace-modal-title { margin: 0; font-size: 1rem; font-weight: 600; }
.workspace-modal-subtitle { margin: 4px 0 0; font-size: .8rem; opacity: .7; }
.workspace-modal-body {
  padding: 24px;
  display: flex;
  flex-direction: column;
  gap: 32px;
  overflow: auto;
  overscroll-behavior: contain;
}
.workspace-section { display: flex; flex-direction: column; gap: 12px; min-width: 840px; }
.workspace-modal-header-actions { display: flex; gap: 8px; align-items: center; }
.workspace-modal-close {
  width: 36px;
  height: 36px;
  border-radius: 10px;
  border: 1px solid rgba(255, 255, 255, .08);
  background: #1c1c22;
  color: #e5e7eb;
  display: flex;
  align-items: center;
  justify-content: center;
  font-size: 18px;
  line-height: 1;
}
.workspace-modal-close:hover { background: #23232a; }
.workspace-modal-close:focus-visible { outline: 2px solid #6366f1; outline-offset: 2px; }
.workspace-section-title { font-size: .95rem; font-weight: 600; }
.workspace-chip-row { display: flex; flex-wrap: wrap; gap: 8px; }
.workspace-card-grid { display: grid; gap: 16px; }
@media (min-width: 720px) { .workspace-card-grid { grid-template-columns: repeat(2, minmax(0, 1fr)); } }
.workspace-modal-footer { display: flex; align-items: center; justify-content: space-between; gap: 16px; padding: 16px 24px; border-top: 1px solid rgba(255, 255, 255, .08); background: rgba(15, 20, 26, .95); backdrop-filter: blur(12px); font-size: .8rem; }
.workspace-modal-status { opacity: .7; }
.workspace-modal-actions { display: flex; align-items: center; gap: 12px; }
.workspace-modal-save { border-radius: 12px; border: 1px solid #f2f4f8; background: #f2f4f8; color: #11151c; padding: 8px 18px; font-size: .9rem; font-weight: 600; cursor: pointer; transition: opacity .2s ease, filter .2s ease; }
.workspace-modal-save:not(:disabled):hover { filter: brightness(.95); }
.workspace-modal-save:disabled { opacity: .45; cursor: not-allowed; }
.workspace-modal-reset { border-radius: 10px; border: 1px solid #2a2f35; background: transparent; color: inherit; padding: 7px 16px; font-size: .85rem; cursor: pointer; transition: background .2s ease, border-color .2s ease; }
.workspace-modal-reset:not(:disabled):hover { background: rgba(255, 255, 255, .06); border-color: rgba(255, 255, 255, .18); }
.workspace-modal-reset:disabled { opacity: .45; cursor: not-allowed; }
.workspace-card { border: 1px solid #2a2f35; border-radius: 18px; padding: 18px; background: rgba(20, 26, 32, .65); display: flex; flex-direction: column; gap: 12px; }
.workspace-card-title { font-size: .95rem; font-weight: 600; }
.workspace-card-hint { margin: 0; font-size: .78rem; opacity: .6; }
.workspace-chip {
  display: inline-flex;
  align-items: center;
  gap: 8px;
  border-radius: 999px;
  border: 1px solid #2a2f35;
  background: rgba(255, 255, 255, .04);
  color: inherit;
  padding: 6px 14px;
  font-size: .82rem;
  cursor: pointer;
  transition: background .2s ease, color .2s ease, border-color .2s ease;
}
.workspace-chip:hover { background: rgba(255, 255, 255, .08); }
.workspace-chip.is-active { background: #f2f4f8; border-color: #f2f4f8; color: #11151c; }
.workspace-chip-icon { display: inline-flex; }
.workspace-number { display: flex; align-items: center; gap: 10px; }
.workspace-number-button { width: 34px; height: 34px; border-radius: 10px; border: 1px solid #2a2f35; background: rgba(255, 255, 255, .04); color: inherit; font-size: 1.1rem; line-height: 1; display: grid; place-items: center; cursor: pointer; transition: background .2s ease, border-color .2s ease; }
.workspace-number-button:hover { background: rgba(255, 255, 255, .12); border-color: rgba(255, 255, 255, .2); }
.workspace-number-input { width: 90px; text-align: center; border-radius: 10px; border: 1px solid #2a2f35; background: #11161b; color: inherit; padding: 7px 10px; font-size: .95rem; }
.workspace-number-input:focus { outline: 2px solid rgba(120, 190, 255, .45); outline-offset: 1px; }
.workspace-range-value { font-size: .78rem; opacity: .65; margin-bottom: 10px; }
.workspace-range { width: 100%; height: 6px; border-radius: 999px; background: #2a2f35; appearance: none; cursor: pointer; }
.workspace-range::-webkit-slider-thumb { appearance: none; width: 16px; height: 16px; border-radius: 50%; border: 1px solid rgba(0, 0, 0, .45); background: #f2f4f8; cursor: pointer; box-shadow: 0 2px 6px rgba(0, 0, 0, .3); }
.workspace-range::-moz-range-thumb { width: 16px; height: 16px; border-radius: 50%; border: 1px solid rgba(0, 0, 0, .45); background: #f2f4f8; cursor: pointer; box-shadow: 0 2px 6px rgba(0, 0, 0, .3); }

@media (max-width: 600px) {
  .workspace-modal-backdrop { padding: 24px 12px; }
  .workspace-modal { width: min(100%, 500px); border-radius: 16px; max-height: calc(100vh - 24px); }
  .workspace-modal-header { padding: 16px 18px; flex-wrap: wrap; gap: 12px; }
  .workspace-modal-body { padding: 20px; gap: 24px; }
  .workspace-modal-footer { padding: 14px 18px; flex-direction: column; align-items: flex-start; gap: 10px; }
  .workspace-modal-actions { width: 100%; justify-content: flex-end; }
}
