:root { --bg:#0f1216; --panel:#11161d; --panel-2:#0c1016; --line:#222b36; --muted:#98a2b3; --text:#e6edf3; --brand:#eef2f7; --accent:#2eaadc; --ok:#1f6feb; --danger:#e11d48; --shadow:0 8px 30px rgba(0,0,0,.25); --radius:14px; --radius-sm:10px; --w-container:920px; }
:root[data-theme="light"] { --bg:#f8fafc; --panel:#fff; --panel-2:#f4f6f8; --line:#e4e8ee; --muted:#667085; --text:#101828; --brand:#111827; --accent:#2563eb; --ok:#2563eb; --danger:#dc2626; }

html, body { -webkit-font-smoothing: antialiased; -moz-osx-font-smoothing: grayscale; text-rendering: optimizeLegibility; }
*{box-sizing:border-box}
html,body,#root{height:100%}
body{margin:0;background:var(--bg);color:var(--text);font-family:Inter,ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Helvetica,Arial}
.muted{color:var(--muted)}
.pill{border:1px solid var(--line);border-radius:999px;padding:6px 10px;background:var(--panel-2);color:var(--text);cursor:pointer;transition:.15s}
.pill.on{border-color:var(--accent);color:var(--accent)}
.pill.sm{font-size:12px;padding:2px 8px;margin-right:6px;margin-top:4px;display:inline-block}
.pill.danger,.mini.danger{border-color:var(--danger);color:var(--danger)}

.cx-shell{height:100%;display:grid;grid-template-columns:300px 1fr}
@media(max-width:980px){.cx-shell{grid-template-columns:1fr}.cx-sidebar{display:none}}

.cx-sidebar{display:flex;flex-direction:column;padding:18px;border-right:1px solid var(--line);background:var(--panel-2)}
.cx-brand{font-weight:800;letter-spacing:.2px;margin-bottom:14px}
.cx-new{background:var(--ok);border:none;color:#fff;border-radius:10px;padding:10px 12px;cursor:pointer;box-shadow:var(--shadow)}
.cx-divider{height:1px;background:var(--line);margin:16px 0}
.cx-flex{flex:1}

.sec{margin-bottom:14px}
.sec-head{display:flex;align-items:center;justify-content:space-between;margin-bottom:8px}
.sec-title{font-weight:700;color:var(--brand)}
.sec-extra .mini{font-size:12px;border:1px solid var(--line);background:var(--panel);color:var(--text);border-radius:999px;padding:4px 8px;cursor:pointer}
.sec-extra .mini.danger{border-color:var(--danger);color:var(--danger)}

.cx-empty-small{font-size:13px}

.conv{display:grid;grid-template-columns:1fr auto auto;gap:8px;align-items:center;padding:10px;border:1px solid var(--line);border-radius:var(--radius-sm);background:var(--panel);cursor:pointer;margin-bottom:8px;transition:.15s}
.conv:hover{border-color:var(--accent)}
.conv.active{border-color:var(--accent);box-shadow:var(--shadow)}
.conv-title{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}
.conv-when{font-size:12px;color:var(--muted)}
.conv-menu details{position:relative}
.conv-menu summary{list-style:none;cursor:pointer;border:1px solid var(--line);border-radius:var(--radius-sm);padding:2px 8px;background:var(--panel-2)}
.conv-menu .menu{position:absolute;right:0;top:120%;background:var(--panel);border:1px solid var(--line);border-radius:10px;min-width:180px;box-shadow:var(--shadow);display:flex;flex-direction:column;z-index:50}
.conv-menu .menu button{background:transparent;color:var(--text);border:none;text-align:left;padding:8px 10px;cursor:pointer}
.conv-menu .menu button:hover{background:var(--panel-2)}

.cx-main{display:grid;grid-template-rows:auto 1fr auto;min-height:100vh;background:var(--panel);color:var(--text)}
.cx-top{display:flex;align-items:center;justify-content:space-between;padding:14px 18px;border-bottom:1px solid var(--line);background:var(--panel-2);position:sticky;top:0;z-index:5}
.title{font-weight:700}
.top-icons{display:flex;gap:8px;align-items:center}
.icon-btn{border:1px solid var(--line);background:var(--panel);color:var(--text);border-radius:12px;padding:6px 10px;cursor:pointer;transition:.15s}
.icon-btn:hover{border-color:var(--accent)}
.avatar-btn{width:34px;height:34px;border-radius:999px;border:1px solid var(--line);background:var(--panel);display:flex;align-items:center;justify-content:center;cursor:pointer;overflow:hidden}
.avatar-btn img{width:100%;height:100%;object-fit:cover;border-radius:999px}
.avatar-btn span{font-weight:700}

.icon-btn, .avatar-btn, .pill, .tab-btn, .seg-item, .btn-secondary, .primary, .danger {
  transition: border-color .15s, box-shadow .15s, transform .04s ease-out;
}
.icon-btn:active, .avatar-btn:active, .quick button:active, .primary:active { transform: translateY(1px); }
.icon-btn:focus-visible, .avatar-btn:focus-visible, .pill:focus-visible,
.tab-btn:focus-visible, .seg-item:focus-visible, .primary:focus-visible,
.btn-secondary:focus-visible, .danger:focus-visible, .cx-input:focus-visible {
  outline: 2px solid var(--accent); outline-offset: 2px;
}

.cx-stream {
  padding: 24px;
  overflow: auto;
  display: flex;
  justify-content: center;
}
.cx-stream-inner {
  width: 100%;
  max-width: var(--w-container);
  padding-bottom: max(24px, env(safe-area-inset-bottom));
}
.cx-hero {
  margin: 8vh auto 0;
  padding: 32px 28px;
  border: 1px solid var(--line);
  background:
    linear-gradient(180deg, rgba(255,255,255,0.02), rgba(0,0,0,0.02)),
    var(--panel);
  border-radius: var(--radius);
  box-shadow: 0 8px 40px rgba(0,0,0,.25);
  text-align: center;
}
.cx-hero h1 { margin: 0 0 8px; font-weight: 800; letter-spacing: .2px; }

.quick { display: flex; gap: 10px; justify-content: center; margin-top: 14px; flex-wrap: wrap; }
.quick button {
  border: 1px solid var(--line);
  background: var(--panel-2);
  color: var(--text);
  border-radius: var(--radius-sm);
  padding: 8px 12px;
  cursor: pointer;
  white-space: nowrap;
  line-height: 1;
}
.quick button:focus-visible { outline: 2px solid var(--accent); outline-offset: 2px; }

.cx-thinking { color: var(--muted); font-style: italic; margin: 12px auto; text-align: center; }

.cx-stream::-webkit-scrollbar { width: 10px; }
.cx-stream::-webkit-scrollbar-thumb { background: var(--line); border-radius: 999px; }
.cx-stream::-webkit-scrollbar-thumb:hover { background: color-mix(in oklab, var(--line), white 10%); }

.cx-compose {
  display: flex;
  justify-content: center;
  gap: 10px;
  padding: 14px 18px;
  border-top: 1px solid var(--line);
  background: var(--panel-2);
  position: sticky;
  bottom: 0;
}
.cx-compose-inner {
  width: 100%;
  max-width: var(--w-container);
  display: flex;
  gap: 10px;
}

.cx-input {
  flex: 1;
  background: var(--panel);
  color: var(--text);
  border: 1px solid var(--line);
  border-radius: var(--radius);
  padding: 14px 16px;
}
.cx-send {
  background: var(--ok);
  color: #fff;
  border: none;
  border-radius: var(--radius-sm);
  padding: 12px 16px;
  box-shadow: var(--shadow);
  cursor: pointer;
}
.cx-send:disabled { opacity: .6; cursor: not-allowed; }

.cx-msg{display:flex;gap:12px;margin:14px 0;}
.cx-msg .avatar{width:34px;height:34px;border-radius:10px;background:var(--panel);display:flex;align-items:center;justify-content:center;border:1px solid var(--line)}
.cx-msg .bubble{flex:1;background:var(--panel);border:1px solid var(--line);border-radius:var(--radius);padding:12px 14px;box-shadow:var(--shadow)}
.cx-msg .meta{display:flex;gap:8px;align-items:center;margin-bottom:6px}
.cx-msg .who{font-weight:700;font-size:13px;color:var(--brand)}
.cx-msg .content{line-height:1.65;word-wrap:break-word;overflow-wrap:anywhere}
.cx-msg .content pre{background:#0b1220;border:1px solid var(--line);padding:12px;border-radius:var(--radius-sm);overflow:auto}
.cx-msg .content code{font-family:ui-monospace,Menlo,Consolas,"SF Mono",monospace}
.actions{display:flex;gap:8px;justify-content:flex-end;margin-top:8px}
.actions .mini{background:var(--panel-2);border:1px solid var(--line);color:var(--text);border-radius:8px;padding:6px 8px;cursor:pointer}

.panel{margin-top:10px;background:var(--panel-2);border:1px solid var(--line);border-radius:12px;padding:6px 10px}
.panel > summary{cursor:pointer;color:var(--muted)}
.kv{margin-top:6px;display:flex;flex-direction:column;gap:6px}
.kv-row{display:flex;gap:8px;align-items:flex-start}
.k{min-width:140px;color:var(--muted);font-size:12px}
.v{flex:1;font-size:13px}

@media (max-width: 640px) {
  :root { --w-container: 100%; }
  .cx-hero { padding: 24px 18px; margin-top: 6vh; }
  .cx-send { padding: 12px 14px; }
  .cx-input { padding: 12px 14px; }
}

/* Modals */
.modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.5);display:flex;align-items:center;justify-content:center;z-index:60}
.modal{background:var(--panel);border:1px solid var(--line);border-radius:14px;min-width:540px;max-width:90vw;box-shadow:var(--shadow)}
.modal.wide{min-width:720px}
.modal-head{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid var(--line)}
.modal-title{font-weight:700}
.modal-body{padding:14px 16px;display:flex;flex-direction:column;gap:14px}
.modal-actions{display:flex;gap:10px;justify-content:flex-end;margin-top:6px}
.modal-actions.right{justify-content:flex-end}
.modal-actions.split{justify-content:space-between}
.primary{background:var(--ok);color:#fff;border:none;border-radius:10px;padding:10px 14px;cursor:pointer}
.danger{border:1px solid var(--danger);color:var(--danger);background:transparent;border-radius:10px;padding:10px 14px;cursor:pointer}
.danger.ghost{background:transparent}

/* Settings controls */
.row{display:flex;align-items:center;justify-content:space-between;gap:12px}
.row > label{color:var(--muted);min-width:220px}
.row .field{flex:1}
.range{display:flex;align-items:center;gap:10px}
.range input[type="range"]{width:100%}
.range-val{color:var(--muted);min-width:42px;text-align:right}
.switch{position:relative;display:inline-block;width:44px;height:24px}
.switch input{opacity:0;width:0;height:0}
.slider{position:absolute;cursor:pointer;top:0;left:0;right:0;bottom:0;background:#6b7280;border-radius:999px;transition:.15s}
.slider:before{content:"";position:absolute;height:18px;width:18px;left:3px;top:3px;background:white;border-radius:50%;transition:.15s}
.switch input:checked + .slider{background:#22c55e}
.switch input:checked + .slider:before{transform:translateX(20px)}
.seg{display:flex;gap:8px;flex-wrap:wrap}
.seg-item{border:1px solid var(--line);background:var(--panel-2);color:var(--text);border-radius:999px;padding:6px 10px;cursor:pointer}
.seg-item.on{border-color:var(--accent);color:var(--accent)}

/* Tabs + profile form */
.tabs{display:flex;flex-direction:column}
.tab-head{display:flex;gap:8px;border-bottom:1px solid var(--line);padding:6px 8px}
.tab-btn{border:1px solid var(--line);background:var(--panel-2);color:var(--text);border-radius:999px;padding:6px 12px;cursor:pointer}
.tab-btn.on{border-color:var(--accent);color:var(--accent)}
.tab-body{padding:14px}
.form .field-row{display:flex;align-items:center;gap:12px;margin-bottom:10px}
.form .field-row .label{min-width:180px;color:var(--muted)}
.form .field-row .control input,.form .field-row .control textarea{width:100%;background:var(--panel-2);color:var(--text);border:1px solid var(--line);border-radius:10px;padding:10px}
.avatar-edit{display:flex;align-items:center;gap:14px;margin-bottom:8px}
.avatar-edit .preview{width:64px;height:64px;border-radius:999px;border:1px solid var(--line);background:var(--panel);overflow:hidden;display:flex;align-items:center;justify-content:center}
.avatar-edit .preview img{width:100%;height:100%;object-fit:cover}
.avatar-edit .preview .ph{font-weight:800;color:var(--brand)}
.avatar-edit .upload{border:1px solid var(--line);background:var(--panel-2);color:var(--text);border-radius:10px;padding:6px 10px;cursor:pointer}
.avatar-edit .upload input{display:none}

/* Delete flow helpers */
.confirm-card{border:1px solid var(--line);background:var(--panel);border-radius:12px;padding:14px}
.confirm-title{margin:0 0 6px}
.note{color:var(--muted);margin:0 0 10px}
.btn-row{display:flex;gap:10px;justify-content:flex-end}
.btn-secondary{border:1px solid var(--line);background:var(--panel-2);color:var(--text);border-radius:10px;padding:10px 14px;cursor:pointer}
.feedback-area{width:100%;background:var(--panel-2);color:var(--text);border:1px solid var(--line);border-radius:10px;padding:10px}
.counter{text-align:right;font-size:12px;color:var(--muted);margin-top:6px}

/* Toast */
.toast{position:fixed;bottom:18px;right:18px;background:var(--panel);border:1px solid var(--line);border-radius:10px;padding:10px 14px;box-shadow:var(--shadow)}
