<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
    <meta name="color-scheme" content="light dark" />
    <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)" />
    <meta name="theme-color" content="#0B0F14" media="(prefers-color-scheme: dark)" />
    <link rel="icon" type="image/png" href="/favicon.png" />
    <title>Nexus Secure Workspace</title>

    <style>html.theme-preload *{transition:none!important}</style>

    <script>
      (function () {
        var ROOT = document.documentElement;
        var SYS = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)');
        var KEYS = ['nexus-theme','theme'];

        function readPref(){
          var v='system';
          try{ for (var i=0;i<KEYS.length;i++){ var s=localStorage.getItem(KEYS[i]); if(s){v=s;break;} } }catch(e){}
          return (v==='light'||v==='dark'||v==='system')?v:'system';
        }
        function sysTheme(){ return SYS && SYS.matches ? 'dark' : 'light'; }
        function apply(pref){
          var eff = pref==='system' ? sysTheme() : pref;
          ROOT.classList.toggle('dark', eff==='dark');
          ROOT.dataset.theme = eff;
          try{ for (var i=0;i<KEYS.length;i++) localStorage.setItem(KEYS[i], pref); }catch(e){}
          return eff;
        }

        window.__setTheme = function(choice){
          if(choice!=='light'&&choice!=='dark'&&choice!=='system') choice='system';
          apply(choice);
        };

        ROOT.classList.add('theme-preload');
        apply(readPref());

        if (SYS){
          var onChange = function(){ try{ if(readPref()==='system') apply('system'); }catch(e){} };
          if (SYS.addEventListener) SYS.addEventListener('change', onChange);
          else if (SYS.addListener) SYS.addListener(onChange);
        }

        window.addEventListener('DOMContentLoaded', function(){
          ROOT.classList.remove('theme-preload');
        });
      })();
    </script>
  </head>
  <body class="bg-app text-ink antialiased">
    <div id="root"></div>
    <script type="module" src="/src/main.tsx"></script>
  </body>
</html>
